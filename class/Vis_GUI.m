classdef Vis_GUI
    
    %UNTITLED Summary of this class goes here
    %   Detailed explanation goes here
    
    properties
        handles
        %         addplottab
    end
    
    methods
        function obj = Vis_GUI
            % defind figure
            f = figure('Position',[300 20 800 800],...
                'Units','pixel',...
                'MenuBar', 'none',...'
                'Name','Visulization GUI',...
                'Tag','vis_gui');
            
            % add workspace uimenu
            menu_new = uimenu(f,'Text','Work',...
                'Tag','uimenu_plot');
            
            % add unit convertor
            menu_unit_setting = uimenu(f,'Text','Unit Setting',...
                'Tag','uimenu_unit_setting');
            
            % add new uimenu
            menu_new_workspace = uimenu(menu_new,'Text','New',...
                'Tag','uimenu_new_workspace');
            
            % add delete uimenu
            menu_delete_workspace = uimenu(menu_new,'Text','Delete',...
                'Tag','uimenu_delete_workspace');
            
            % add tabgroup
            tabgp = uitabgroup(f,'Position',[.05 .05 .90 .90],...
                'TabLocation','top',...
                'Tag','tabgroup_plot');
            
            % update property
            obj.handles = guihandles(f);
        end
        
        function tab1=addplot(obj)
            
            % create a tab
            tab1 = uitab(obj.handles.tabgroup_plot,'Title','New');
            
            % add an axes on tab
            axes1 = axes(tab1,'Position',[0.1 0.30 0.75 0.65],...
                'Tag','axes_plot');
            
            % add condition to a tab
            condition = uicontrol('style','Edit',...
                'String','',...,
                'HorizontalAlignment','left',...
                'Parent',tab1,...
                'FontSize',10,...
                'ForegroundColor','r',...
                'FontName', 'Cascadia Code',...
                'Units','normalized',...
                'Position',[0.20 0.19 0.65 0.040],...
                'Max',1,...
                'Backgroundcolor','k',...
                'Tag','txt_condition',...
                'Enable','on');
            
            % add text condition
            text_condition = uicontrol('style','text',...
                'String','Condition :',...,
                'HorizontalAlignment','right',...
                'FontSize',10,...
                'FontWeight','bold',...
                'ForegroundColor','r',...
                'Parent',tab1,...
                'Units','normalized',...
                'Position',[0.1 0.19 0.10 0.04],...
                'Max',4,...
                'Tag','txt_c',...
                'Enable','on');
            
            % add command plot to a tab
            command = uicontrol('style','Edit',...
                'String','',...,
                'HorizontalAlignment','left',...
                'Parent',tab1,...
                'FontSize',10,...
                'ForegroundColor','g',...
                'FontName', 'Cascadia Code',...
                'Units','normalized',...
                'Position',[0.20 0.08 0.35 0.105],...
                'Max',4,...
                'Backgroundcolor','k',...
                'Tag','txt_command',...
                'Enable','on');
            
            % add option plot to a tab
            opt = uicontrol('style','Edit',...
                'String','',...,
                'HorizontalAlignment','left',...
                'Parent',tab1,...
                'FontSize',10,...
                'ForegroundColor','g',...
                'FontName', 'Cascadia Code',...
                'Units','normalized',...
                'Position',[0.55 0.08 0.30 0.105],...
                'Max',4,...
                'Backgroundcolor','k',...
                'Tag','txt_option',...
                'Enable','on');
            
            % add text plot
            text_command = uicontrol('style','text',...
                'String','Plot :',...,
                'HorizontalAlignment','right',...
                'FontSize',10,...
                'FontWeight','bold',...
                'ForegroundColor','g',...
                'Parent',tab1,...
                'Units','normalized',...
                'Position',[0.1 0.15 0.10 0.04],...
                'Max',4,...
                'Tag','txt_p',...
                'Enable','on');
            
            % add apply_command plot
            apply_command = uicontrol('style','pushButton',...
                'String','Apply',...,
                'HorizontalAlignment','center',...
                'Parent',tab1,...
                'Units','normalized',...
                'Position',[0.88 0.18 0.10 0.05],...
                'Max',4,...
                'Tag','txt_apply',...
                'Enable','on');
            
            % add save_command plot
            save_command = uicontrol('style','pushButton',...
                'String','Save...',...,
                'HorizontalAlignment','center',...
                'Parent',tab1,...
                'Units','normalized',...
                'Position',[0.88 0.13 0.10 0.05],...
                'Max',4,...
                'Tag','txt_save',...
                'Enable','on');
            
            % add load_command plot
            load_command = uicontrol('style','pushButton',...
                'String','Load...',...,
                'HorizontalAlignment','center',...
                'Parent',tab1,...
                'Units','normalized',...
                'Position',[0.88 0.08 0.10 0.05],...
                'Max',4,...
                'Tag','txt_load',...
                'Enable','on');
            % add path display
            path = uicontrol('style','text',...
                'String','path:',...,
                'HorizontalAlignment','left',...
                'Parent',tab1,...
                'Units','normalized',...
                'Position',[0.20 0.01 0.75 0.05],...
                'Max',4,...
                'Tag','txt_path',...
                'Enable','on');
            
        end
        
        function deletework(obj)
            % create gui
            tabgp = obj.handles.tabgroup_plot;
            
            % check selected tab
            tabgp.SelectedTab.Parent=[];
        end
        
        function f = unit_conversion(obj, objbeam)
            % create GUI class for unit conversion
            num_unit = length(fieldnames(objbeam.unit));
            height_f = (num_unit+1)*40;
            width_f = 420;
            f= figure( ...
                'Tag', 'figure1', ...
                'Units', 'pixels', ...
                'Position', [500 100 width_f height_f], ...
                'Name', 'Unit Convertor', ...
                'MenuBar', 'none', ...
                'NumberTitle', 'off', ...
                'Color', get(0,'DefaultUicontrolBackgroundColor'),...
                'Tag','unit_conv');
            
            fieldunit = fieldnames(objbeam.unit);
            old_unit = struct2cell(objbeam.unit);
            
            % display possible units (new unit)
            posunit = cellfun(@(u) setunit(u), fieldunit,'UniformOutput',0);
            
            % current units (old units)
            old_units = cellfun(@(u) getfield(objbeam.unit,u),fieldunit,'UniformOutput',0); 
            
            % default on popup unit
            test= cellfun(@(v,u) strcmp(v,u),posunit,old_unit,'UniformOutput',0);
            default_value_unit = cellfun(@(i) find(i==true),test,'UniformOutput',0);
            
            % GUI dimensions
            height_g = 30;
            width_g = 80;
            margin_left = 40;
            margin_top = 20;
            width_body = round((width_f-2*margin_left)/3);            
            
            % header
            for i=1:1
            % column1
                g1(i) = uicontrol( ...
                    'Parent', f, ...
                    'Style', 'text', ...
                    'Units', 'pixels', ...
                    'Position', [margin_left height_f-margin_top-i*height_g width_g height_g], ...
                    'FontName', 'Arial', ...
                    'FontSize', 10, ...
                    'FontWeight', 'normal', ...
                    'String', 'Quantity', ...
                    'HorizontalAlignment', 'left');
             % column2   
                g2(i) = uicontrol( ...
                    'Parent', f, ...
                    'Style', 'text', ...
                    'Units', 'pixels', ...
                    'Position', [margin_left+width_body height_f-margin_top-i*height_g width_g height_g], ...
                    'FontName', 'Arial', ...
                    'FontSize', 10, ...
                    'FontWeight', 'normal', ...
                    'String', 'Old unit', ...
                    'HorizontalAlignment', 'left');
                % column3
                g3(i) = uicontrol( ...
                    'Parent', f, ...
                    'Style', 'text', ...
                    'Units', 'pixels', ...
                    'Position', [margin_left+width_body*2 height_f-margin_top-i*height_g width_g height_g], ...
                    'FontName', 'Arial', ...
                    'FontSize', 10, ...
                    'FontWeight', 'normal', ...
                    'String', 'New unit', ...
                    'HorizontalAlignment', 'left');
            end
            
            % table
            for i=2:length(fieldnames(objbeam.unit))+1
                tag_newunit{i-1} = sprintf('tag_newunit%d',i-1);
            % column1
                g1(i) = uicontrol( ...
                    'Parent', f, ...
                    'Style', 'text', ...
                    'Units', 'pixels', ...
                    'Position', [margin_left height_f-margin_top-i*height_g width_g height_g], ...
                    'FontName', 'Arial', ...
                    'FontSize', 10, ...
                    'FontWeight', 'normal', ...
                    'String', fieldunit{i-1}, ...
                    'HorizontalAlignment', 'left');
             % column2   
                g2(i) = uicontrol( ...
                    'Parent', f, ...,
                    'Style', 'text', ...
                    'Units', 'pixels', ...
                    'Position', [margin_left+width_body height_f-margin_top-i*height_g width_g height_g], ...
                    'FontName', 'Arial', ...
                    'FontSize', 10, ...
                    'FontWeight', 'normal', ...
                    'String', old_unit{i-1}, ...
                    'HorizontalAlignment', 'left');
                % column3
                g3(i) = uicontrol( ...
                    'Parent', f, ...
                    'Style', 'popup', ...
                    'Tag',tag_newunit{i-1},...
                    'Units', 'pixels', ...
                    'Position', [margin_left+width_body*2 height_f-margin_top-i*height_g width_g height_g], ...
                    'FontName', 'Arial', ...
                    'FontSize', 10, ...
                    'FontWeight', 'normal', ...
                    'String', posunit{i-1}, ...,
                    'Value',default_value_unit{i-1},...
                    'HorizontalAlignment', 'left');
            end
            % apply 
            for i=length(fieldnames(objbeam.unit))+2
                
                g2(i) = uicontrol( ...
                    'Parent', f, ...
                    'Style', 'pushbutton', ...
                    'Units', 'pixels', ...
                    'Position', [margin_left height_f-margin_top-i*height_g width_g height_g], ...
                    'FontName', 'Arial', ...
                    'FontSize', 10, ...
                    'FontWeight', 'normal', ...
                    'String', 'Cancel', ...
                    'HorizontalAlignment', 'left',...
                    'Tag','cancelunit');
                
                % column3
                g3(i) = uicontrol( ...
                    'Parent', f, ...
                    'Style', 'pushbutton', ...
                    'Units', 'pixels', ...
                    'Position', [margin_left+width_body height_f-margin_top-i*height_g 2*width_body height_g], ...
                    'FontName', 'Arial', ...
                    'FontSize', 10, ...
                    'FontWeight', 'normal', ...
                    'String', 'Apply', ...
                    'HorizontalAlignment', 'center',...
                    'Tag','applyunit');
            end
            
            
        end
    end
end

